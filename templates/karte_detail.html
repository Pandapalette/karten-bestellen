{% extends "base.html" %}
{% block content %}
<h1 class="text-3xl font-bold text-purple-700 mb-4">
    Chat zu Karte {{ order.nummer }} von {{ ingame_name }}
</h1>
<p class="mb-4 text-gray-600">GrÃ¶ÃŸe: {{ order.breite }}Ã—{{ order.hoehe }} â€“ Preis: {{ "{:,.0f}".format(order.preis) }} ğŸ’°</p>

<div class="bg-white shadow rounded p-4 max-w-2xl mx-auto mb-6">
    <div class="h-96 overflow-y-auto border p-3 rounded space-y-3">
        {% for msg in messages %}
        <div class="{% if msg.user == user %}text-right{% else %}text-left{% endif %}">
            <div class="inline-block bg-purple-100 p-2 rounded-lg max-w-[80%]">
                <p class="text-sm text-gray-700"><strong>{{ msg.user }}</strong></p>
                {% if msg.text %}
                    <p>{{ msg.text }}</p>
                {% endif %}
                {% if msg.image %}
                    <img src="{{ url_for('uploaded_file', filename=msg.image) }}" class="max-w-xs rounded mt-1">
                {% endif %}
                <p class="text-xs text-gray-500">{{ msg.time[:16].replace("T", " ") }}</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <form method="POST" enctype="multipart/form-data" class="mt-4 flex gap-2 items-center">
        <input name="text" placeholder="Nachricht..." class="flex-grow border p-2 rounded">
        <input type="file" name="bild" class="text-sm">
        <button class="bg-purple-600 text-white px-3 py-2 rounded hover:bg-purple-700">Senden</button>
    </form>
</div>

<a href="{{ url_for('meine_auftraege') }}" class="text-blue-500 hover:underline">â† ZurÃ¼ck zu meinen AuftrÃ¤gen</a>
{% endblock %}

<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Karte {{ ingame_name }} #{{ order.nummer }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background:#f5f5f5; padding:20px; }
    .detail-container { background:white; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.2); }
    img { max-width:100%; border-radius:10px; margin-bottom:15px; }
    .chat-box { border:1px solid #ccc; padding:10px; height:250px; overflow-y:auto; border-radius:10px; background:#f9f9f9; margin-bottom:15px; }
    .chat-message { margin-bottom:8px; }
    .chat-user { font-weight:bold; }
    form { display:flex; gap:10px; }
    form input { flex:1; }
  </style>
</head>
<body>

<div class="detail-container">
  <h3>Karte {{ ingame_name }} #{{ order.nummer }}</h3>
  <p>Größe: {{ order.breite }} x {{ order.hoehe }}</p>
  <p>Preis: {{ order.preis | int | format }} Coins</p>
  <img src="{{ url_for('uploaded_file', filename=order.bild) }}" alt="Bild der Karte">

  <h5>Chat</h5>
  <div class="chat-box">
    {% for msg in messages %}
      <div class="chat-message">
        <span class="chat-user">{{ msg.user }}:</span> {{ msg.text }}
      </div>
    {% endfor %}
  </div>

  {% if 'user' in session %}
    <form method="POST">
      <input type="text" name="text" placeholder="Nachricht schreiben..." required>
      <button type="submit" class="btn btn-primary">Senden</button>
    </form>
  {% else %}
    <p><em>Bitte einloggen, um Nachrichten zu senden.</em></p>
  {% endif %}

  <a href="{{ url_for('home') }}" class="btn btn-secondary mt-3">⬅️ Zurück</a>
</div>

</body>
</html>
